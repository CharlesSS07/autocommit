#!/usr/bin/env bash

AUTOCOMMIT_SCRIPT_DIR=$(dirname $0)

# source $AUTOCOMMIT_SCRIPT_DIR/autocommit-env

GIT_HOOK_FILE=.git/hooks/autocommit
GIT_HOOK_PREPARE_COMMIT_MSG_FILE=.git/hooks/prepare-commit-msg

touch $GIT_HOOK_FILE
chmod a+x $GIT_HOOK_FILE

if grep -Fxq "$INSTALLATION_INDICATOR_LINE" $GIT_HOOK_FILE
then
	echo "Autocommit has already been installed in this repository."
else
	cat $AUTOCOMMIT_SCRIPT_DIR/autocommit-env $AUTOCOMMIT_SCRIPT_DIR/autocommit-hook | grep -v "#" | grep -v "^$" >> $GIT_HOOK_FILE
	# paste in environment, and hook, remove comments, and empty lines
fi

